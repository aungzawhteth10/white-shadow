{% include 'base.html' %}
<script >
    	var division = {
	    view:"form",
	    id:"detail_form",
	    scroll:"y", 
	    autoheight:true,
	    borderless:true,
	    elements:[
{% for no in 1..14 %}
			{id:"row_{{no}}", hidden:true, rows:[
		        {cols:[
		        	{},
		            {view:"button", id:"division_{{no}}", value:"", css:"webix_primary", height:50, width:300, click:function() {logic.detail_add({{no}});}},
		        	{}
		        ]},
			]},
{% endfor %}
    ]};
    var to_back = {view:"button", id:"to_back", value:"ပြန်သွားမည်", css:"webix_primary", height:50, width:100};
	var footer = {view:"label", label:"<footer style='text-align:center;>'>white-shadow</footer>"};
	webix.ready(function () {
		webix.ui(
		{rows:[
			division,
			to_back,
			footer,
			{height:75}
		]}
		);
		logic.init();
	});
	var logic = {
		init: function() {
			logic.auth();
			logic.dataload();
			$$("to_back").attachEvent("onItemClick", logic.to_back);
		},
		auth: function() {
			var auth_key = webix.storage.session.get("auth_key") || "";
			if (auth_key != "@^apo9324kl.w;mmshh;fji@#asdf423$^&^&%$$45852$$#") {
				var _url = webix.storage.session.get("url");
				location.href= _url + "auth";
			}
		},
		dataload: function() {
			$.get("/divisionList", {}, function(data) {
				var obj = JSON.parse(data);
				var length = obj.length;
				webix.storage.session.put("division", obj);
				for (var i = 1; i <= length; i++) {
					logic.setAndView(i, obj[i-1]);
				}
			});
		},
		setAndView: function(no, obj) {
			var _division_id = "division_" + no;
			$$(_division_id).setValue(obj.division);
			var _row_id = "row_" + no;
			$$(_row_id).show();
		},
		detail_add: function(no) {
			var _id = "division_" + no;
			var _division = $$(_id).getValue();
			webix.storage.session.put("division", _division);
			var _url = webix.storage.session.get("url");
			location.href= _url + "control_detail_add";
		},
		to_back: function() {
			var _url = webix.storage.session.get("url");
			location.href= _url + "control_room";
		}
	}	      
</script>